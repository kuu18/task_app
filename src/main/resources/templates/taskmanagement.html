<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<title>タスク管理</title>
<link th:href="@{/webjars/bootstrap/5.1.3/css/bootstrap.min.css}" rel="stylesheet" >
<script th:inline="javascript">
	/*_$tag____*/
	function actionFunc(val) {
		url = /*[[ @{/} ]]*/
		document.forms['form'].action = url + val;
		document.forms['form'].submit();
	}
	/*_$t*/
</script>
</head>
<body >
  <header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-md-3 col-lg-1 me-0 px-3" th:href="@{/task/management}">TaskApp</a>
    <form class="col-md-3 d-flex justify-content-end" th:action="@{/task/management}" method="post">
        <input class="form-group me-3 flex-grow-1" type="text" placeholder="タスク名検索" name="nameKey">
        <button class="btn btn-outline-success" type="submit">検索</button>
    </form>
  </header>
  
  <div class="container-fluid">
    <div class="row">
      <main class="col">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom" th:if="${latestTaskList}" >
          <h1 class="h2">直近のタスク</h1>
          <div class="btn-toolbar mb-2 mb-md-0">
            <form th:action="@{/task/form}" method="post">
                <button type="submit" class="btn btn-outline-primary">タスク登録</button>
            </form>
          </div>
        </div>
  
        <div class="album py-5 bg-light" th:if="${latestTaskList}">
          <div class="container">
      
            <div class="row row-cols-md-3 g-3">
              <div class="col-sm-6" th:each="task : ${latestTaskList}" th:object="${task}">
                <div class="card text-white bg-success mb-3">
                  <div class="card-header d-flex justify-content-between mb-2">
                    <h5 class="h5" th:text="*{name}"></h5>
                    <form class="d-flex justify-content-end" th:action="@{'/task/statusupdate/' + *{taskId}}" method="post">
                      <button type="submit" class="btn btn-outline-light btn-sm" th:text="*{status} ? '完了' : '未完了'"></button>
                    </form>
                  </div>
                  <div class="card-body">
                    <p class="card-text" th:text="*{content}"></p>
                  </div>
                  <div class="card-footer">
                    <small th:text="'期限：' + *{deadLine}"></small>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

  
        <h2 th:text="${latestTaskList} ? 'タスク一覧' : '検索結果'"></h2>
        <div class="table-responsive">
          <table class="table table-striped table-sm">
            <thead>
              <tr>
                <th>タスク名</th>
                <th>タスク内容</th>
                <th>期限</th>
                <th>ステータス</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="task : ${list}" th:object="${task}">
                <td th:text="*{name}">トイレ掃除</td>
                <td th:text="*{content}">トイレを掃除する</td>
                <td th:text="*{deadLine}">2022-02-01-19:00</td>
                <form th:action="damy" name="form" method="post">
                  <td><button type="button" class="btn-sm btn-outline-primary" th:text="*{status} ? '完了' : '未完了'" th:onclick="|actionFunc('task/statusupdate/__*{taskId}__')|"></button></td>
                  <td>
                    <div class="btn-group btn-group-sm" role="group" aria-label="Basic outlined example">
                      <button type="button" class="btn btn-outline-primary" th:onclick="|actionFunc('task/form/__*{taskId}__')|" >編集</button>
                      <button type="button" class="btn btn-outline-primary" th:onclick="|actionFunc('task/delete/__*{taskId}__')|" >削除</button>
                    </div>
                  </td>
                </form>
              </tr>
            </tbody>
          </table>
        </div>
      </main>
    </div>
  </div>
</body>
</html>